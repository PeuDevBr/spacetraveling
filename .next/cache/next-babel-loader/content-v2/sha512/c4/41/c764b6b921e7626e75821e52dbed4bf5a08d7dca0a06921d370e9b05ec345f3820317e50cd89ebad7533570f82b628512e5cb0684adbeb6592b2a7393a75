{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/peu/documentos/peudevbr/ignite/newRevisando/spacetraveling/src/pages/index.tsx\";\nimport Link from 'next/link';\nimport Prismic from '@prismicio/client';\nimport { format } from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport { FiCalendar, FiUser } from 'react-icons/fi';\nimport { useState } from 'react';\nimport Head from 'next/head';\nimport { getPrismicClient } from '../services/prismic';\nimport commonStyles from '../styles/common.module.scss';\nimport styles from './home.module.scss';\nimport Header from '../components/Header';\nexport default function Home({\n  postsPagination,\n  preview\n}) {\n  const {\n    0: posts,\n    1: setPosts\n  } = useState(postsPagination.results);\n  const {\n    0: nextPage,\n    1: setNextPage\n  } = useState(postsPagination.next_page);\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n\n  async function handleNextPage() {\n    if (currentPage !== 1 && nextPage === null) {\n      return;\n    }\n    /* Recebe as informações da próxima página e armazena em  postsResults */\n\n\n    const postsResults = await fetch(`${nextPage}`).then(response => response.json());\n    setNextPage(postsResults.next_page);\n    setCurrentPage(postsResults.page);\n    const newPosts = postsResults.results.map(post => {\n      return {\n        uid: post.uid,\n        first_publication_date: post.first_publication_date,\n        data: {\n          title: post.data.title,\n          subtitle: post.data.subtitle,\n          author: post.data.author\n        }\n      };\n    });\n    setPosts([...posts, ...newPosts]);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Home | spacetraveling\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: commonStyles.container,\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.container,\n        children: posts.map(post => /*#__PURE__*/_jsxDEV(Link, {\n          href: `/post/${post.uid}`,\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            className: styles.postContent,\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              children: post.data.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: post.data.subtitle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(FiCalendar, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 87,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: format(new Date(post.first_publication_date), 'dd MMM yyyy', {\n                    locale: ptBR\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 88,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(FiUser, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 97,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: post.data.author\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 98,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 96,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 15\n          }, this)\n        }, post.uid, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n        children: nextPage && /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: styles.postLink,\n          onClick: handleNextPage,\n          children: \"Carregar mais posts\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), preview && /*#__PURE__*/_jsxDEV(\"aside\", {\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/api/exit-preview\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            className: commonStyles.preview,\n            children: \"Sair do modo Preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\nexport const getStaticProps = async ({\n  preview = false\n}) => {\n  const prismic = getPrismicClient();\n  const postsResponse = await prismic.query([Prismic.Predicates.at('document.type', 'publication')], {\n    pageSize: 1\n  });\n  const posts = postsResponse.results.map(post => {\n    return {\n      uid: post.uid,\n      first_publication_date: post.first_publication_date,\n      data: {\n        title: post.data.title,\n        subtitle: post.data.subtitle,\n        author: post.data.author\n      }\n    };\n  });\n  const postsPagination = {\n    next_page: postsResponse.next_page,\n    results: posts\n  };\n  return {\n    props: {\n      postsPagination,\n      preview\n    }\n  };\n};","map":{"version":3,"sources":["/home/peu/documentos/peudevbr/ignite/newRevisando/spacetraveling/src/pages/index.tsx"],"names":["Link","Prismic","format","ptBR","FiCalendar","FiUser","useState","Head","getPrismicClient","commonStyles","styles","Header","Home","postsPagination","preview","posts","setPosts","results","nextPage","setNextPage","next_page","currentPage","setCurrentPage","handleNextPage","postsResults","fetch","then","response","json","page","newPosts","map","post","uid","first_publication_date","data","title","subtitle","author","container","postContent","Date","locale","postLink","getStaticProps","prismic","postsResponse","query","Predicates","at","pageSize","props"],"mappings":"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","sourcesContent":["import { GetStaticProps } from 'next';\nimport Link from 'next/link';\n\nimport Prismic from '@prismicio/client';\nimport { format } from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport { FiCalendar, FiUser } from 'react-icons/fi';\nimport { useState } from 'react';\nimport Head from 'next/head';\nimport { getPrismicClient } from '../services/prismic';\n\nimport commonStyles from '../styles/common.module.scss';\nimport styles from './home.module.scss';\nimport Header from '../components/Header';\n\ninterface Post {\n  uid?: string;\n  first_publication_date: string | null;\n  data: {\n    title: string;\n    subtitle: string;\n    author: string;\n  };\n}\n\ninterface PostPagination {\n  next_page: string;\n  results: Post[];\n}\n\ninterface HomeProps {\n  postsPagination: PostPagination;\n  preview: boolean;\n}\n\nexport default function Home({\n  postsPagination,\n  preview,\n}: HomeProps): JSX.Element {\n  const [posts, setPosts] = useState<Post[]>(postsPagination.results);\n  const [nextPage, setNextPage] = useState<string>(postsPagination.next_page);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n\n  async function handleNextPage(): Promise<void> {\n    if (currentPage !== 1 && nextPage === null) {\n      return;\n    }\n\n    /* Recebe as informações da próxima página e armazena em  postsResults */\n    const postsResults = await fetch(`${nextPage}`).then(response =>\n      response.json()\n    );\n\n    setNextPage(postsResults.next_page);\n    setCurrentPage(postsResults.page);\n\n    const newPosts = postsResults.results.map(post => {\n      return {\n        uid: post.uid,\n        first_publication_date: post.first_publication_date,\n        data: {\n          title: post.data.title,\n          subtitle: post.data.subtitle,\n          author: post.data.author,\n        },\n      };\n    });\n\n    setPosts([...posts, ...newPosts]);\n  }\n\n  return (\n    <>\n      <Head>\n        <title>Home | spacetraveling</title>\n      </Head>\n      <main className={commonStyles.container}>\n        <Header />\n        <div className={styles.container}>\n          {posts.map(post => (\n            <Link key={post.uid} href={`/post/${post.uid}`}>\n              <a className={styles.postContent}>\n                <h1>{post.data.title}</h1>\n                <p>{post.data.subtitle}</p>\n                <ul>\n                  <li>\n                    <FiCalendar />\n                    <span>\n                      {format(\n                        new Date(post.first_publication_date),\n                        'dd MMM yyyy',\n                        { locale: ptBR }\n                      )}\n                    </span>\n                  </li>\n                  <li>\n                    <FiUser />\n                    <span>{post.data.author}</span>\n                  </li>\n                </ul>\n              </a>\n            </Link>\n          ))}\n        </div>\n        <footer>\n          {nextPage && (\n            <button\n              type=\"button\"\n              className={styles.postLink}\n              onClick={handleNextPage}\n            >\n              Carregar mais posts\n            </button>\n          )}\n        </footer>\n\n        {preview && (\n          <aside>\n            <Link href=\"/api/exit-preview\">\n              <a className={commonStyles.preview}>Sair do modo Preview</a>\n            </Link>\n          </aside>\n        )}\n      </main>\n    </>\n  );\n}\n\nexport const getStaticProps: GetStaticProps = async ({ preview = false }) => {\n  const prismic = getPrismicClient();\n\n  const postsResponse = await prismic.query(\n    [Prismic.Predicates.at('document.type', 'publication')],\n    {\n      pageSize: 1,\n    }\n  );\n\n  const posts = postsResponse.results.map(post => {\n    return {\n      uid: post.uid,\n      first_publication_date: post.first_publication_date,\n      data: {\n        title: post.data.title,\n        subtitle: post.data.subtitle,\n        author: post.data.author,\n      },\n    };\n  });\n\n  const postsPagination = {\n    next_page: postsResponse.next_page,\n    results: posts,\n  };\n\n  return {\n    props: { postsPagination, preview },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}